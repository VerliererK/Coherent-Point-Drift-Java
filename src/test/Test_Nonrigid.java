package test;

import com.cklin.cpd.CPD;
import com.cklin.cpd.Method;
import com.cklin.math.ArraysUtils;

import java.io.IOException;


public class Test_Nonrigid {

    public static void main(String[] args) throws IOException {
        CPD cpd = new CPD(x, y);
        cpd.opt.method = Method.NonRigid;
        cpd.opt.outliers = 0.0;
        cpd.opt.plot = true;
        cpd.opt.fgt = false;
        cpd.opt.print = true;
        TimeUtils.tic();
        double[][] TY = cpd.register();
        TimeUtils.toc();
        ArraysUtils.print(cpd.interp(y[10], y, 0.1, 0));
        ArraysUtils.print(TY[10]);
        Plot result = new Plot();
        result.figure_title("result");
        result.addXYSeries("X", x);
        result.addXYSeries("Y", y);
        result.addXYSeries("TY", TY);
        result.show();
    }


    static double[][] x = new double[][]{
            {-0.915419160617181, -0.165350787755089},
            {-0.890508968073163, -0.102128427731091},
            {-0.857295378014471, -0.102128427731091},
            {-0.824081787955779, -0.149545197749088},
            {-0.873902173043818, -0.196961967767090},
            {-0.923722558131855, -0.165350787755089},
            {-1.06488031588129, -0.291795507803090},
            {-1.02336332830793, -0.165350787755089},
            {-0.981846340734565, -0.0547116577130885},
            {-0.956936148190546, 0.0243162923169097},
            {-0.915419160617181, 0.119149832352915},
            {-0.882205570558490, 0.182372192376913},
            {-0.807474992926434, 0.261400142406917},
            {-0.757654607838395, 0.340428092436916},
            {-0.674620632691666, 0.466872812484917},
            {-0.583283260030264, 0.545900762514922},
            {-0.516856079912881, 0.609123122538919},
            {-0.400608514707460, 0.703956662574924},
            {-0.334181334590076, 0.814595792616925},
            {-0.267754154472692, 1.16231877274893},
            {-0.201326974355308, 1.46262498286293},
            {-0.151506589267271, 1.76293119297694},
            {-0.143203191752599, 1.88937591302494},
            {-0.118292999208580, 2.11065417310894},
            {-0.101686204179233, 1.96840386305494},
            {-0.0933828066645603, 1.74712560297094},
            {-0.0933828066645603, 1.54165293289294},
            {-0.0850794091498875, 1.30456908280293},
            {-0.0933828066645603, 1.11490200273093},
            {-0.0767760116352148, 0.909429332652924},
            {-0.0767760116352148, 0.719762252580925},
            {-0.0435624215765237, 0.561706352520923},
            {-0.0352590240618492, 0.482678402490918},
            {0.0477749510848785, 0.403650452460919},
            {0.114202131202262, 0.340428092436916},
            {0.164022516290301, 0.277205732412918},
            {0.222146298893012, 0.213983372388915},
            {0.296876876525067, 0.103344242346915},
            {0.363304056642450, -0.00729488769508558},
            {0.446338031789180, -0.0863228377250904},
            {0.504461814391891, -0.0547116577130885},
            {0.570888994509275, 0.0401218823229107},
            {0.604102584567966, 0.182372192376913},
            {0.670529764685350, 0.387844862454919},
            {0.728653547288059, 0.624928712544920},
            {0.819990919949463, 0.672345482562923},
            {0.903024895096192, 0.767179022598922},
            {0.886418100066847, 0.624928712544920},
            {0.869811305037501, 0.466872812484917},
            {0.861507907522827, 0.261400142406917},
            {0.836597714978809, 0.103344242346915},
            {0.844901112493481, -0.133739607743093},
            {0.844901112493481, -0.307601097809091},
            {0.844901112493481, -0.528879357893097},
            {0.878114702552172, -0.734352027971097},
            {0.927935087640211, -0.892407928031100},
            {0.986058870242922, -1.00304705807311},
            {1.03587925533096, -1.12949177812111},
            {1.04418265284563, -1.20851972815111},
            {0.969452075213575, -1.14529736812711},
            {0.886418100066847, -1.05046382809110},
            {0.795080727405445, -0.971435878061104},
            {0.687136559714695, -0.924019108043102},
            {0.595799187053293, -0.829185568007102},
            {0.537675404450582, -0.750157617977098},
            {0.471248224333200, -0.639518487935098},
            {0.413124441730489, -0.576296127911100},
            {0.288573479010394, -0.528879357893097},
            {0.188932708834319, -0.465656997869094},
            {0.0892919386582440, -0.465656997869094},
            {-0.0352590240618492, -0.497268177881095},
            {-0.0850794091498875, -0.497268177881095},
            {-0.00204543400315814, -0.576296127911100},
            {0.0975953361729168, -0.655324077941098},
            {0.172325913804973, -0.686935257953100},
            {0.263663286466376, -0.734352027971097},
            {0.213842901378337, -0.734352027971097},
            {0.0394715535702057, -0.734352027971097},
            {-0.151506589267271, -0.734352027971097},
            {-0.267754154472692, -0.718546437965102},
            {-0.400608514707460, -0.671129667947099},
            {-0.467035694824843, -0.607907307923096},
            {-0.558373067486246, -0.528879357893097},
            {-0.599890055059610, -0.513073767887096},
            {-0.774261402867742, -0.465656997869094},
            {-0.890508968073163, -0.481462587875095},
            {-0.981846340734565, -0.434045817857092},
            {-1.03997012333728, -0.370823457833094},
            {-1.05657691836662, -0.291795507803090},
            {-0.0504819195054163, -0.758060412980095},
            {0.0996711855515862, -0.758060412980095}};
    static double[][] y = new double[][]{
            {-1.31145782066443, -0.227364263495814},
            {-1.30291795936642, -0.195668709934514},
            {-1.27125904393043, -0.198913547872126},
            {-1.22711540633310, -0.228594817463525},
            {-1.26347518338845, -0.249331362155124},
            {-1.31940964393762, -0.226502633223340},
            {-1.42497090243178, -0.280255983049959},
            {-1.41347435727676, -0.216909133550904},
            {-1.39893751979569, -0.162815295558369},
            {-1.39305010041958, -0.123897642872372},
            {-1.37565915011293, -0.0775938983382813},
            {-1.35935695671900, -0.0464814206219776},
            {-1.31024909992507, -0.00794984770906926},
            {-1.28393135228050, 0.0332447555445036},
            {-1.24055093631406, 0.102838923991370},
            {-1.18214055370522, 0.149041232194286},
            {-1.14235783805090, 0.188407627748399},
            {-1.07184375891146, 0.252097944226789},
            {-1.04478733481545, 0.331886077079079},
            {-1.04278251573898, 0.620816522222673},
            {-0.985229545386503, 0.933997027830626},
            {-0.869646812152130, 1.30092876740863},
            {-0.806566258453428, 1.46571408186240},
            {-0.661461640851822, 1.76377991768230},
            {-0.731191214797838, 1.57473032374463},
            {-0.831981747630126, 1.28734733837758},
            {-0.895333374371487, 1.03639038334864},
            {-0.917706172270894, 0.776567028109510},
            {-0.916412261565992, 0.592112098471855},
            {-0.871338391585206, 0.417390224550821},
            {-0.821695824795221, 0.271406807245892},
            {-0.741063878288004, 0.158462426126190},
            {-0.703899356063232, 0.103220036202054},
            {-0.597976336570793, 0.0477162694560376},
            {-0.509457553354280, 0.00261754034819914},
            {-0.433831662199203, -0.0429902886253477},
            {-0.348507376415943, -0.0894388762691745},
            {-0.222663055461617, -0.172436757376602},
            {-0.104014075420129, -0.258347610532043},
            {0.0176403440647821, -0.323069150622294},
            {0.0641675919494613, -0.298728063940065},
            {0.0901965060911154, -0.221426661126096},
            {0.0574330827037970, -0.105291266456101},
            {0.0328511286761617, 0.0661641121653253},
            {-0.00169435638234178, 0.270357037946825},
            {0.0960545688771011, 0.327775178297801},
            {0.178313332960139, 0.429325515539655},
            {0.200407387076452, 0.299643532446118},
            {0.238692671927654, 0.160414991057359},
            {0.316041107790626, -0.0152231781572039},
            {0.357609520160152, -0.152520224803613},
            {0.474448878939486, -0.357899155074491},
            {0.550273231137208, -0.513895211948580},
            {0.639965107231283, -0.718352534993915},
            {0.750120282430399, -0.913316400237813},
            {0.852291113760249, -1.06560489848680},
            {0.942611447575976, -1.17223684912682},
            {1.01997723997005, -1.29359023468569},
            {1.04043633209614, -1.36958187899716},
            {0.951885946742434, -1.30975066030771},
            {0.843588266747391, -1.21761619049798},
            {0.723028419575636, -1.13819190004852},
            {0.586448532594669, -1.08496742755009},
            {0.454512307124548, -0.985552421530614},
            {0.364603992877903, -0.904724414351941},
            {0.255614351996361, -0.795156168197106},
            {0.170840454528542, -0.731095786598646},
            {0.0199282037280402, -0.671772986189787},
            {-0.104904307297282, -0.603747433325817},
            {-0.208194666333585, -0.587283821790955},
            {-0.326182627877614, -0.589698129179404},
            {-0.376395492387561, -0.580401083880869},
            {-0.271962032924521, -0.657850823858721},
            {-0.150507401662078, -0.742045984056194},
            {-0.0639611460230193, -0.783988259676388},
            {0.0468799451486551, -0.843532446039818},
            {-0.00824539729753809, -0.833221200791870},
            {-0.194457941620793, -0.795053353353902},
            {-0.386738808640062, -0.752200931292090},
            {-0.503476459749821, -0.713786172948520},
            {-0.644957107049077, -0.647839661101539},
            {-0.728482014139109, -0.586078255563016},
            {-0.844914323507718, -0.510062215703361},
            {-0.892639292883548, -0.490605886048497},
            {-1.08853933241681, -0.425032749265939},
            {-1.20465973611251, -0.414391268289012},
            {-1.31031216924451, -0.371061063086399},
            {-1.38318882975700, -0.326753589308361},
            {-1.41708325396197, -0.281115629037974},
            {-0.281812821588075, -0.794323315398814},
            {-0.126700053318089, -0.828507740347991}};
}
